<launch>

  <arg name="gui" default="true" doc="If this value is true, visualize with rviz." />
  <arg name="map_link" default="/map" doc="map frame id" />
  <arg name="panoramic_scan" default="false" doc="Set to true if the scan covers 360 degree" />
  <arg name="stride" default="1" doc="Use this to skip laser points" />
  <arg name="conf_thresh" default="0.8" doc="Threshold for confidence" />
  <arg name="gpu" default="-1" doc="If this value is greater than or equal to 0, the gpu corresponding to that number will be used." />

  <include file="$(find jsk_perception)/sample/include/play_rosbag_lidar_people.xml" />

  <node name="dr_spaam_lidar_person_detection"
        pkg="jsk_perception" type="lidar_person_detection_node.py"
        output="screen">
    <remap from="~input" to="/base_scan" />
    <rosparam subst_value="true" >
      map_link: $(arg map_link)
      weight_file: "$(find jsk_perception)/trained_data/lidar_person_detection/ckpt_jrdb_ann_dr_spaam_e20.pth"
      detector_model: "DR-SPAAM"
      conf_thresh: $(arg conf_thresh)
      stride: $(arg stride)
      panoramic_scan: $(arg panoramic_scan)
      gpu: $(arg gpu)
    </rosparam>
  </node>

  <group if="$(arg gui)" >
    <node name="rviz"
          pkg="rviz" type="rviz"
          args="-d $(find jsk_perception)/sample/config/sample_lidar_person_detection.rviz" >
    </node>
  </group>

</launch>
